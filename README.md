graph TB
    A[ImageCaptioningYOLOModel] --> B[resnet: Sequential]
    B --> C0[Conv2d: 3 -> 64, kernel=7x7, stride=2x2, padding=3x3]
    B --> C1[BatchNorm2d: 64 channels]
    B --> C2[ReLU(inplace=True)]
    B --> C3[MaxPool2d: kernel=3, stride=2, padding=1]
    
    C3 --> D0[Sequential Block 1]
    D0 --> E0[Bottleneck Block]
    E0 --> F1[Conv1: Conv2d(64, 64)]
    E0 --> F2[BatchNorm2d(64)]
    E0 --> F3[Conv2: Conv2d(64, 64, kernel=3x3)]
    E0 --> F4[BatchNorm2d(64)]
    E0 --> F5[Conv3: Conv2d(64, 256)]
    E0 --> F6[BatchNorm2d(256)]
    E0 --> F7[ReLU(inplace=True)]
    E0 --> F8[Downsample: Conv2d(64, 256)]

    D0 --> E1[Bottleneck Block]
    E1 --> F9[Conv1: Conv2d(256, 64)]
    E1 --> F10[BatchNorm2d(64)]
    E1 --> F11[Conv2: Conv2d(64, 64, kernel=3x3)]
    E1 --> F12[BatchNorm2d(64)]
    E1 --> F13[Conv3: Conv2d(64, 256)]
    E1 --> F14[BatchNorm2d(256)]
    E1 --> F15[ReLU(inplace=True)]

    C3 --> D1[Sequential Block 2]
    D1 --> G0[Bottleneck Block]
    G0 --> H1[Conv1: Conv2d(256, 128)]
    G0 --> H2[BatchNorm2d(128)]
    G0 --> H3[Conv2: Conv2d(128, 128, kernel=3x3, stride=2)]
    G0 --> H4[BatchNorm2d(128)]
    G0 --> H5[Conv3: Conv2d(128, 512)]
    G0 --> H6[BatchNorm2d(512)]
    G0 --> H7[ReLU(inplace=True)]
    G0 --> H8[Downsample: Conv2d(256, 512)]

    D1 --> G1[Bottleneck Block]
    G1 --> H9[Conv1: Conv2d(512, 128)]
    G1 --> H10[BatchNorm2d(128)]
    G1 --> H11[Conv2: Conv2d(128, 128, kernel=3x3)]
    G1 --> H12[BatchNorm2d(128)]
    G1 --> H13[Conv3: Conv2d(128, 512)]
    G1 --> H14[BatchNorm2d(512)]
    G1 --> H15[ReLU(inplace=True)]

    B --> C7[Final Block: Bottleneck Conv2d(1024, 512)]
    C7 --> C8[BatchNorm2d(512)]
    C7 --> C9[Conv2: Conv2d(512, 2048)]
    C7 --> C10[ReLU(inplace=True)]
